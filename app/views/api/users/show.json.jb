user =render partial: "user.json.jb", locals: { user: @user}

user[:groups] = @user.groups.map do |group|
  render partial: "api/groups/group", locals: {group: group}
end

user[:games] = @user.games.map do |game|
  render partial: "api/games/game", locals: {game: game}
end

user